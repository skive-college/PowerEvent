@page
@model PowerEvent.HoldOpsaetningModel
@{
    ViewData["Title"] = "HoldOpsaetning";
}

<h1>HoldOpsaetning</h1>

<p>Event:</p>
<style> #EventList { width: 120px; } #EventList:focus { min-width: 120px; width: auto; } </style>
<select id="EventList" asp-for="@Model.SelectedEvent" onchange="eventListChanged()">
    @{
        if (Model.SelectedEvent == -1)
        {
            <option label="Vælg et event"></option>
        }
        foreach (var pevent in Model.EventList)
        {
            //if (pevent.Id == Model.SelectedEvent)
            //{
            //    <option label="@pevent.Navn" value="@pevent.Id" selected></option>
            //}
            //else
            //{
                <option label="@pevent.Navn" value="@pevent.Id"></option>
            //}
        }
    }
</select>

@{ 
    if (Model.SelectedEvent != -1)
    {
        <div class="container">
            <div class="row">
                <div class="col-sm-5">
                    <form method="post">
                        <p>Spillers navn</p>
                        <input type="text" asp-for="@Model.DeltagerNavn"/>
                        <input type="submit" value="Opret" formmethod="post" asp-page-handler="CmdSubmitDeltagerNavn"/>
                    </form>
                    <select id="deltagerselect" style="min-width:150px; min-height:400px" multiple>
                        @{
                            foreach (var deltager in Model.DeltagerList)
                            {
                                if (deltager.HoldId != null)
                                {
                                    string holdnavn = Model.HoldList.Find(x => x.Id == deltager.HoldId).Navn;
                                    <option label="@(string.Format("{0} - {1}", deltager.Navn, holdnavn))" value="@deltager.Id"></option>
                                }
                                else
                                {
                                    <option label="@deltager.Navn" value="@deltager.Id"></option>
                                }
                            }
                        }
                    </select>
                    <button onclick="">Fjern</button>
                </div>
                <div class="col-sm-2">
                    <div>
                        <select id="holdselect">
                            @{ 
                                foreach (var hold in Model.HoldList)
                                {
                                    <option label="@hold.Navn" value="@hold.Id"></option>
                                }
                            }
                        </select>
                        <button onclick="">Random</button>
                        <button onclick="">Tilføj</button>
                    </div>
                    
                </div>
                <div class="col-sm-5">
                    <select disabled multiple style="min-width:300px">
                        @{
                            foreach (var deltager in Model.DeltagerList)
                            {
                                if (deltager.HoldId != null)
                                {
                                    string holdnavn = Model.HoldList.Find(x => x.Id == deltager.HoldId).Navn;
                                    <option label="@(string.Format("{0} - {1}", deltager.Navn, holdnavn))"></option>
                                }
                            }
                        }
                    </select>
                </div>
            </div>
        </div>
    }
}

<script>
    function eventListChanged() {
        let list = document.getElementById("EventList");
        let items = list.children;
        let id = items.item(list.selectedIndex).getAttribute("value");

        let url = new URL(location.href)
        url.searchParams.set("Event", id)
        location.href = url
    }

</script>

